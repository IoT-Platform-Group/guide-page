# 2018.7.15 第一次需求分析会议讨论成果

## IPS

定位：

* 和负载均衡中间件交互
* 必要时具备和设备直接交互的能力
* 低阶的数据格式化，将设备发上来的原生数据解析为格式化数据
* 将解析出来的格式化数据存入数据库，并以API的形式发送给业务层（让业务层用于条件判断等处理）



注意点：

* IPS的上行API将数据即时传递给业务层
* 在调用上行API之前，会**基于数据库内的设备监听信息对于信息进行过滤**，只有需要被监听的设备信息（例如作为触发条件、作为监控预警目标的设备的信息）才被传递给业务层
* 主要数据直接存入数据库，供数据访问操作时查询用



## 业务层

定位：

* 为应用层提供数据（API形式）
* 应用层可以通过对该层下达指令的形式操控设备
* 应用层可以设置各类监听事件类操作，包括
  * 设备参数监控预警提示
  * 设备行为判定预警提示
  * 设备条件自动触发



注意点：

* 来自IPS的上行API不是完整的数据，仅用于事件即时触发
* 纯数据访问型操作通过数据库进行访问
* 来自设备的config行为设定和用于设定的事件行为均应该整合在这一层进行逻辑处理



## 问题

* CoAP协议中，如何较好的实现下行设备推送
* 设备强制获取最新状态问题
* 设备唤醒问题（设备是可以唤醒的休眠，还是真休眠）

